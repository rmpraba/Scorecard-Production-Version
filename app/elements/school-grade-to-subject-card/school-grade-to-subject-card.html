   <link rel="import" href="..\..\bower_components/gold-email-input/gold-email-input.html">
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
   <link rel="import" href="..\..\bower_components/polymer/polymer.html">
  <link rel="import" href="../demosumbit-card/demosumbit-card.html">


   <dom-module id="school-grade-to-subject-card">
   <template>
    <style>  
      :host {
        display: block;
      }   
      .card1{ 
        margin-left:5%;
        margin-top: 4%;
      }
      .card2
      {
        margin-left:40%;
         margin-top:-21%;
      }   
      .outcard
      {
      width:25% 
      margin-left:5.0em;
      }
       .innercard
       {     
        @apply(--layout-horizontal);
        width:100%
        margin-left:2.5em;
       }
     .innercard1
     {
       @apply(--layout-horizontal);
       width:100%
      margin-left:5.0em;
     }
     .tt
     {      
      width:70%;
     }   
   .outer1
      {
        border-radius: 10px;
        border: 2px solid #6699ff;
        padding: 0px;
        margin-top: 4%;
        width: 60%;
        margin-left: 19%;
        min-height: 300px;
      }

       .subbutton paper-button
      {
        @apply(--layout-right);
        background-color: #363636;
        color: #ffffff;                
        width: 15%;
        margin-left: 80%;
        margin-top: 7%;
      }
      .sbutton
      {
        @apply(--layput-right);
        background-color: #363636;
        color: #ffffff;  
        width: 9%;
        margin-left: 50%;        
      }
      .subbcatt
      {
        margin-left: 36%;
      }
      .newwwwcardd
    {
      overflow-y: scroll;
      overflow-x: hidden;
    }
    .language
    {
       margin-left: 39%;
      margin-top: -7%;
      position: absolute;
    }
    </style>


    <div>
      <CENTER>
        <h3><b>GRADE TO SUBJECT MAPPING</b></h3>
      </CENTER>
    </div>
   
    <div>
      <div class="outer1">
        <div class="col-sm-4">
          <div class="form-group-heading">
            <h4>SCHOOL TYPE</h4>
          </div>
          <template is="dom-repeat" items="{{schooltypegrarr}}" as="view">
            <school-type-item-card schooltypenamexx="{{view.school_type_name}}" schooltypeidxx="{{view.school_type_id}}" id="GDSUB{{view.school_type_id}}"></school-type-item-card>
          </template>  
        </div>      
        <div class="subbcatt">
          <div class="form-group-heading">   
            <h4> SUBJECT CATEGORY</h4>
          </div>   
          <template is="dom-repeat" items="{{schoolcategoryarr}}" as="view">
            <schoolcategory-type-item-card schooltypecategoryid="{{view.subject_category_id}}"
            id="GDCAT{{view.subject_category_id}}" schooltypecategoryname="{{view.subject_category_name}}" ></schoolcategory-type-item-card>
          </template>   
        </div>    
      <div class="language">
            <paper-dropdown-menu id="empLanguageprefernce1" label="Select The language Type">
               <paper-menu id="empLanguageprefernce1id" class="dropdown-content" on-iron-select="empfnselectlanprefercence" attr-for-selected="value" required>
                 <paper-item value="coresub">Core Subject</paper-item>
                 <paper-item value="2language">Second Language</paper-item>
                 <paper-item value="3language">Third Language</paper-item>
             </paper-menu>
            </paper-dropdown-menu>
         </div>
    
          <div class="subbutton">
            <paper-button on-click="Generate">Generate</paper-button>
          </div>
          
      </div>     
    </div>

  <div id="tbz1" hidden$="{{hidenewsubcat}}">
    <div class="list-group col-sm-12 panel-body form-category">
      <table class="table table-bordered">
      <div class="container">
        <thead>
          <tr>
            <td class="innercard" style="width: 760px;margin-left: 21%;">
              <template is="dom-repeat" items="{{setsubjectarr}}" as="view">
                <h4 style="width:22%;">{{view.srtarr}}</h4>   
              </template>
            </td>
          </tr> 
        </thead> 
        <tbody class="newwwwcardd col-sm-12" style="width: 1190px;height: 400px;"> 
          <template is="dom-repeat" items="{{bigarr}}" as="view"> 
            <!-- <tr> 
              <td>Save</td>
              <td>Delete</td>
            </tr>   --> 
            <tr>
              <td class="outcard">
                <h4 style="width: 203px;">{{view.subject_name}}</h4>
              </td>
              <td class="innercard" style="width: 800px;">
                <template is="dom-repeat" items="{{view.subject}}" as="s">
                <school_grade-subject-item-card id="{{s.id}}" getsubjectname="{{view.subject_id}}" getgradename="{{s.grade_id}}" cattype="{{s.schooltypenamexx}}" getname="{{schooltypesubjectid}}" getschoolcategory="{{schooltypename}}" emplanpreff="{{emplangprefernce}}"></school_grade-subject-item-card>
               </template>
              </td>
              <td>
                <paper-icon-button  id="btn1" icon="save" on-click="FnSavez"></paper-icon-button>
                <paper-tooltip for="btn1">Save</paper-tooltip>
              </td>
              <td>
                <paper-icon-button  id="btn2" icon="close"  on-click="fndelete"></paper-icon-button>
                <paper-tooltip for="btn2">Delete</paper-tooltip>
              </td>
            </tr>
          </template>
        </tbody>
      </div>    
    </table>  
    </div>    
    </div>    
     

   <demosumbit-card id="mydialog"></demosumbit-card>  
    <master-ui-service id="uiservice"></master-ui-service>



  </template>
  <script>
  (function() {
    'use strict';   
    var getgradearr=[];
    var getcategory=[];  
    var passservicearr=[];
    var delpassservicearr=[];
    var overall1=[];
    Polymer({
      is: 'school-grade-to-subject-card',   
       /*ready:function()
       {
       this.$.tbz1.hidden=true;
       this.$.empLanguageprefernce1.hidden=true;
      },*/
       getgrade:function(arr1){
         getgradearr=arr1;
       //  alert(JSON.stringify(getgradearr));
       },
       getcategory:function(arr){
       getcategory=arr;
           //alert(JSON.stringify(getcategory));
      },
     
      fnapssgradedetails:function(arr){
        passservicearr=arr;  
      },
      fndelapssgradedetails:function(arr){
         delpassservicearr=arr; 
      },

 
          langprefere:function(e){
        //   alert('1');
          if(sessionStorage.getItem("curr_sess_loggedschoolcategory_id")=='category1'){
                  this.$.empLanguageprefernce1.hidden=false;
                }
            else{

              this.$.empLanguageprefernce1.hidden=true;
              var empty='empty';
              document.querySelector('schoolcategory-type-item-card').fnsetemployeelanprefer(empty);
               }   
             },
        clean:function(e){
        this.$.empLanguageprefernce1.hidden=true;
      },
      empfnselectlanprefercence:function(e){
        this.emplangprefernce=e.target.selectedItem.textContent.trim();
        document.querySelector('schoolcategory-type-item-card').fnsetemployeelanprefer(this.emplangprefernce);
         
      },
      FnSavez:function(e)
      {
           //alert('save');
           //alert(JSON.stringify(passservicearr));
           this.$.uiservice.fnsubjecttocategorysaving(passservicearr);
           this.$.mydialog.toggleDialog();
         //  passservicearr=[];
           document.querySelector('school_grade-subject-item-card').Fngradeclean(); 
     },
     fndelete:function(e)
     {
        this.$.uiservice.fndeletegradetosubmapping(delpassservicearr);
        this.$.mydialog.toggleDialog1();
     document.querySelector('school_grade-subject-item-card').Fngradeclean1(); 
    
     },
  
       Generate:function(){

         this.schooltypesubjectid=sessionStorage.getItem("curr_sess_loggedschooltype_ids");
        this.schooltypename=sessionStorage.getItem("curr_sess_loggedschoolcategory_id");
       // alert(this.schooltypesubjectid+this.schooltypename);
    
        if(overall1!=0){
                 document.querySelector('school_grade-subject-item-card').Fngradeclean11(); 
    
             }
              var setarrr=[];
                 for(var i=0;i<getgradearr.length;i++){
                          var gradename=getgradearr[i].grade_name;
                          
                            var obj={"srtarr":""};
                                obj.srtarr=gradename;
                               setarrr.push(obj);
                              // alert(JSON.stringify(obj));
                          }
               //  alert(JSON.stringify(setarrr));
                   this.setsubjectarr=setarrr;
                var generatearr=[];
                var subarr=[];
                for(var j=0;j<getcategory.length;j++){
                     for(var i=0;i<getgradearr.length;i++){
                   var subjectname=getcategory[j].subject_name;
                    var subject_id=getcategory[j].subject_id;
                         
                         var obj={"Grade_name":"","subject_name":"","subject_id":"","grade_id":""}; 
                           var gradename=getgradearr[i].grade_name;
                          var grade_id=getgradearr[i].grade_id;
                           obj.Grade_name=gradename;
                           obj.subject_name=subjectname;
                           obj.grade_id=grade_id;
                           obj.subject_id=subject_id;
                           generatearr.push(obj);
                        }}//alert(JSON.stringify(generatearr));
        var a=[];
        var overall=[];
       for(var k=0;k<generatearr.length;k++)
       {       
         var nameobj={"subject_name":"","subject_id":""};
         nameobj.subject_name=generatearr[k].subject_name; 
         nameobj.subject_id=generatearr[k].subject_id; 
       
         var obj={"Grade_name":"","grade_id":""};
        // obj.Grade_name=generatearr[k].gradename;
        obj.Grade_name=generatearr[k].Grade_name;
        obj.grade_id=generatearr[k].grade_id;
        obj.id=generatearr[k].subject_id+generatearr[k].grade_id;
        a.push(obj);
        for(var l=k+1;l<generatearr.length;l++)
        {
           if(generatearr[k].subject_name==generatearr[l].subject_name)
           {
             var obj1={"Grade_name":"","grade_id":""}
             //obj1.Grade_name=generatearr[l].gradename;
             obj1.Grade_name=generatearr[l].Grade_name;
             obj1.grade_id=generatearr[l].grade_id;
             obj1.id=generatearr[k].subject_id+generatearr[l].grade_id;

             //alert('1');
             //alert(JSON.stringify(obj1));
             a.push(obj1);
             //alert(JSON.stringify(a));
             generatearr.splice(l,1);
             l--;
           // alert(JSON.stringify(generatearr));
         }}
            nameobj.subject=a;
            overall.push(nameobj);
            overall1.push(nameobj);
       
          // alert(JSON.stringify(obj1));
           a=[];

       }
         this.bigarr=overall;
           this.schooltypesubjectid=sessionStorage.getItem("curr_sess_loggedschooltype_ids");
             this.schooltypename=sessionStorage.getItem("curr_sess_loggedschoolcategory_id");
    
       this.$.uiservice.fngetThefunction(this.schooltypesubjectid,this.schooltypename,this.emplangprefernce);
         overall.splice();
         generatearr=[];
         this.$.tbz1.hidden=false;
    
        },

        fnngrades:function()
        {
           this.$.tbz1.hidden=true;
           this.$.empLanguageprefernce1.hidden=true;
           if(document.querySelector('#empLanguageprefernce1id').selected!=-1)
           {
            document.querySelector('#empLanguageprefernce1id').selected=-1;
           }
        } 

    });
  })();
  </script>
</dom-module>
