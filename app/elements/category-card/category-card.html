
<link rel="import" href="..\..\bower_components/polymer/polymer.html">
<link rel="import" href="..\..\bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/iron-icons/maps-icons.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu-light/paper-dropdown-menu-light.html">


<dom-module id="category-card">
  <template>
    <style>
      :host
      {
         margin-left: 10%;
        display: block;      
         @apply(--layout-center);
        /*width: 40%;*/
      }
      .card          
      {
         @apply(--layout-center);
        width: 55%;
        margin-left: 10%;
      }
      .title
      {
        @apply(--layout-center);
        width: 255%;
        margin-left: 33%; 
      }
       .creatediv paper-button
      {
      background-color: #363636;
      color: #ffffff;
      width: 7%;
      margin-left: 39%;
      margin-top: 3%;
      }

      .buttons paper-button
      {
        @apply(--layout-right);
      background-color: #363636;
      color: #ffffff;
      width: 10%;
      margin-top: 6%;
      }
     
      .popup-btn
      {
        /*margin: 0 auto;*/
        @apply(--layout-right);
        margin-left: 30%;
      }
       table
       {
        @apply(--layout-horizontal);
         border-collapse: collapse;
        border: 1px solid #dedede;
        width: 60%;
        margin-left: 35%;
        margin-top: 5%;
      }
      /*.outcard
      {
        @apply(--layout-horizontal);
      }*/
      .newcatcardddd
      {
        margin-left: -2%;
      }

      .creatediv
      {
         border-radius: 10px;
          border: 1px solid #6699ff;
          padding: 10px; 
          width: 25%;
          margin-left: -5%;
          margin-top: -26%;
          min-height: 270px;
      }
      .newtitle
      {
        line-height: 5px;
        margin-top: 10%;
      }
      
    </style>
     
  <div class="title"> 
        <h3><b>CATEGORY</b></h3>
  </div>

  <div class="outcard" hidden$="{{hideoutcard}}">
    <div class="newcatcardddd" hidden$="{{hidenewcatcard}}">
    <div>
       <div class="newtitile" style="margin-left:50%">
          <h4>Current Category Type Details</h4>
        </div>
      <table>
          <tr>
              <th><label style="margin-left:5%">Category ID</label></th>
              <th><label style="margin-left:-6%">Category Name</label></th>
          </tr>

          <template is="dom-repeat" items="{{catarr}}" as="ca">
              <tr><td colspan="3">
              <category-display-card  categoryname="{{ca.category_name}}" categoryid="{{ca.category_id}}"  categorytype="{{ca.category_type}}" hidecategoryinput="true" hidecategoryitem="false">  </category-display-card></td>
              </tr>
          </template>   
      </table>
    </div>
    </div>

    <div hidden>{{temphidden}}</div>
    
    <div class="creatediv">
        <div class="card">
              <label><b>Create New Category</b></label>
              <paper-input readonly  hidden value="{{categorytype}}" label="Category Type"></paper-input>
              <paper-input value="{{categoryname}}" label="Category Name" on-change="fnseq"></paper-input>
        </div>  

        <div class="buttons">
              <paper-button  class="popup-btn" on-click="FnSubmit">Submit </paper-button>    
        </div>
    </div>
  </div>
    
    <master-ui-service id="uiservice"></master-ui-service>

  </template>

    <script>
    (function() {
    'use strict';
       var cname="";
    Polymer({
      is: 'category-card',

      ready:function()
      {
       //alert("hiiiiii");   
       this.$.uiservice.FnFetchCategorySeq();
       this.$.uiservice.FnFetchCategoryname();
       this.$.hidenewcategorycard=true;
      },
      FnRefresh:function()
      {
         this.categoryname=""; 
      },
      fnseq:function(){
         this.$.uiservice.FnFetchCategorySeq();
       },
      FnSubmit:function()
      {
        if(this.categoryname!=null)
        {

        //alert("test");

        var categoryid=(this.categoryname).toLowerCase();
        //alert(this.categoryname);

        this.$.uiservice.FnSetCategoryInfo(this.categorytype,this.categoryname,categoryid,this.temphidden);

          cname=this.toTitleCase(this.categoryname);
          var categoryid=((cname).toLowerCase()).replace(' ','');
          this.$.uiservice.FnSetCategoryInfo(this.categorytype,cname,categoryid,this.temphidden);

         document.querySelector('category-card').FnRefresh(); 
        }
        else if(this.categoryname==null || this.categoryname=="")
        {
          alert("Please enter categoryname before submit"); 
        }
      },

      toTitleCase:function(str)
      {
         return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
      },

      categoryyhide:function()
      {
        this.hidenewcatcard=true;
      },
      categoryyview:function()
      {
        this.hidenewcatcard=false;
      }
      
      
    });
  })();
  </script>
</dom-module>
