<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="student-list-pass-section-card">
  <template>
    <style>
      :host {
        display: block;  
      }
      .outcard{
      /*@apply(--layout-horizontal);  
      margin-left: 10%;*/
       @apply(--layout-horizontal);
      margin-left:4.0em;
      width:100%
     }
    </style>
    <div class="outcard">
       <div class="list-group col-sm-12 panel-body form-category">
          <paper-input  hidden>{{gender}}</paper-input>
          <paper-input  hidden>{{dob}}</paper-input>
          <paper-input  hidden>{{admissinno}}</paper-input>
          <paper-input  hidden>{{admissinno1}}</paper-input>
          <paper-input  hidden>{{classid}}</paper-input>
          <paper-input  hidden>{{noofstudent}}</paper-input>
          <paper-checkbox  on-change="fnsudentGrade" id="{{id}}" checked="{{check}}">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</paper-checkbox>
        </div>
      
       <paper-dialog id="noofstudent1" modal>
       <h2>Cannot add more students to the section.</h2>
            <paper-button  dialog-confirm autofocus style="color:white;background-color:black;margin-left: 59%;"> close</paper-button>
   </paper-dialog>
   
      </div>  
  </template>
  <script>
  (function() {
    'use strict';
  var paspstuinfo=[];
  var spliceid;
  var rr;
  var studentcheckinfoarr=[];
  var v=[];
  //var checkvalu=[];
    Polymer({
      is: 'student-list-pass-section-card',
      
     
      fnsudentGrade:function(e){
      //  alert(this.noofstudent);
        rr=this.admissinno;
        // alert(rr);
   //alert(document.querySelector('#'+this.id).checked);
        
  
 if(document.querySelector('#'+this.id).checked==true){
      
      var count=0;
         for(var i=0;i<studentcheckinfoarr.length;i++){
      //   alert(studentcheckinfoarr[i].class_id+" "+this.classid);
           if(studentcheckinfoarr[i].class_id==this.classid){
            count++;
          }
        }
   /*     alert(count+" "+paspstuinfo.length);
     alert(count+paspstuinfo.length+" "+this.noofstudent);
   */  
    //  alert(count+" "+this.noofstudent);
      if(count<this.noofstudent){
    
    var obj={"id1":"","id":"","student_name":"","dob":"","gender":"","enq_id":"","classid":"",};
            obj.id1=this.id;
            obj.id=this.admissinno;
            obj.student_name=this.studentname;
            obj.dob=this.dob;
            obj.gender=this.gender;
            obj.enq_id=this.id;
            obj.classid=this.classid;
            paspstuinfo.push(obj);
            v.push(obj);
          
         for(var i=0;i<paspstuinfo.length;i++){
                    if(paspstuinfo[i].id==this.admissinno){
                            
                   if(paspstuinfo[i].classid==this.classid){
                  var m=paspstuinfo[i].enq_id;
                  document.querySelector('#'+m).checked=true;
                   }
                  else if(paspstuinfo[i].classid!=this.classid){
                   var s=paspstuinfo[i].enq_id;
                  document.querySelector('#'+s).checked=false;
                    paspstuinfo.splice(i,1);
                   
                }
              } 
             }  
           }
           else{
             this.$.noofstudent1.open();
             document.querySelector('#'+this.id).checked=false;
                }
                var c=0;
          for(var k=0;k<paspstuinfo.length;k++){
            if(paspstuinfo[k].classid==this.classid){
             //  alert(k+count+"  "+this.noofstudent);
                   if(k+count+1<this.noofstudent){
               
                   }else{
                   var wrr=paspstuinfo[k].id1;
                //   alert(wrr);
                document.querySelector('#'+wrr).checked=false;
                  //       alert("filll in the section");
                  paspstuinfo.splice(k,1); 
                  this.$.noofstudent1.open();
                     this.f22();
                   }
             } 
             c++;
           }
        //   alert(c+count+" "+this.noofstudent);
           if(c+count!=this.noofstudent){
             
          document.querySelector('Student-to-section-mapping-card').stupersonalinfo12();
        }
        document.querySelector('Student-to-section-mapping-card').stupersonalinfo(paspstuinfo);  
        }
  else if(document.querySelector('#'+this.id).checked==false){
             for(var i=0;i<paspstuinfo.length;i++){
               paspstuinfo.splice(i,1);
            }
            }  
       },
       studentcheckinfo1:function(arr){
     // alert(JSON.stringify(arr));
        studentcheckinfoarr=arr;
       },
       f11:function(e){
         var c=paspstuinfo.length;
        // alert(c);
        //alert()   
              if(paspstuinfo!=0){
                this.fnsplice();
              } 
          },
        stupersonalinfo11:function(arr){
         //  alert(rr);
        //alert(this.admissinno);  
          for(var i=0;i<arr.length;i++){

            if(arr[i].admno==rr){
                var m=arr[i].dd;
           document.querySelector('#'+m).checked=false;

           }}},
   overallinfo:function(e){
      for(var i=0;i<v.length;i++){
               var empty=v[i].enq_id;
              document.querySelector('#'+empty).checked=false;           
             }

              var obj={"id":"","student_name":"","dob":"","gender":"","enq_id":"","classid":"",};
            obj.id=this.admissinno;
            obj.student_name=this.studentname;
            obj.dob=this.dob;
            obj.gender=this.gender;
            obj.enq_id=this.id;
            obj.classid=this.classid;
            v.splice(obj);
          },
         fnsplice:function(){
              var rnwn=paspstuinfo.length;
              //alert(rnwn);
               if(rnwn>0){

                 for(var i=0;i<paspstuinfo.length;i++){
               spliceid=paspstuinfo[i].enq_id;
              document.querySelector('#'+spliceid).checked=false;
              }
             var obj={"id":"","student_name":"","dob":"","gender":"","enq_id":"","classid":"",};
            obj.id=this.admissinno;
            obj.student_name=this.studentname;
            obj.dob=this.dob;
            obj.gender=this.gender;
            obj.enq_id=this.id;
            obj.classid=this.classid;
            paspstuinfo.splice(obj);
           }
        },
        stupersonalinfo13:function(arr){
           //alert(JSON.stringify(arr));

                for(var k=0;k<arr.length;k++){
                      var  dbid=arr[k].dd;
                    //  alert(dbid);
                    document.querySelector('#'+dbid).checked=false;
           }
     }

    });
  })();  
  </script>
</dom-module>
